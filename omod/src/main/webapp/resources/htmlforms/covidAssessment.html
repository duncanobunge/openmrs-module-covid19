<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->
<htmlform>
	<script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
	<script type="text/javascript">

        var pAge = parseInt('<lookup expression="patient.age"/>');
		jQuery(function($) {
            //Defaults
            jq('#tbl-other-vaccine-1').hide();
            jq('#tbl-other-vaccine-2').hide();
            jq('#tr-vaccine-type-1').hide();
            jq('#tbl-vaccine-1').hide();
            jq('#tbl-vaccine-booster').hide();
            jq('#tbl-test-results').hide();
            jq('#tbl-positive-results').hide();

            //Patient Vaccinated
            jq("#patient-vaccinated :input[type=radio]").change(onPatientVaccinatedSelected);

            //Booster vaccine
            jq("#booster-dose-given :input[type=radio]").change(onBoosterVaccineSelected);

            //Other vaccine specifications
            jq('#vaccine-type-1 select').change(otherVaccine1Selected);
            jq('#vaccine-type-2 select').change(otherVaccine2Selected);

            //JNJ first vaccine specified
            jq('#vaccine-type-1 select').change(otherJNJSelected);

            //Test status
            jq("#test-status :input[type=radio]").change(onTestStatusSelected);

            //Positive Test status
            jq("#test-result :input[type=radio]").change(onPositiveResultSelected);

		});

        var otherVaccine1Selected = function () {
            var val = jq(this).val();
            // Specify other
            if (val == 5622){
                jq('#tbl-other-vaccine-1').show();
            }else{
                jq('#tbl-other-vaccine-1').hide();
            }
        }
        var otherVaccine2Selected = function () {
            var val = jq(this).val();
            // Specify other
            if (val == 5622){
                jq('#tbl-other-vaccine-2').show();
            }else{
                jq('#tbl-other-vaccine-2').hide();
            }
        }

        var otherJNJSelected = function () {
            var val = jq(this).val();
            // JNJ selected
            if (val == 166355){
                jq('.tr-vaccine-type-2 :input').hide();
                var secondVaccineType=jq('#vaccine-type-2');
                var secondVaccineOther=jq('#other-vaccine-2');
                var secondDose=jq('#dose-2');
                getField('vaccine-2-date.value').val("");
                jq("#verified-2 input[value=164134]").prop("checked", false);
                clearHiddenSections([secondDose,secondVaccineType,secondVaccineOther,secondDose]);
            }else{
                jq('.tr-vaccine-type-2 :input').show();
            }
        }

        var onPatientVaccinatedSelected = function () {
            var val = jq(this).val();
            // No selected
            if (val == 1065){
                jq('#tbl-vaccine-1').show();
            }else{
                jq('#tbl-vaccine-1').hide();
            }
        }

       var onBoosterVaccineSelected = function () {
                var val = jq(this).val();
           if (val == 1065){
               jq('#tbl-vaccine-booster').show();
           }else{
               jq('#tbl-vaccine-booster').hide();

               var boosterVaccineType=jq('#booster-type');
               getField('booster-date.value').val("");
               getField('booster-dose.value').val("");
               jq("#booster-verified input[value=164134]").prop("checked", false);
               clearHiddenSections([boosterVaccineType]);
           }
         }

        var onTestStatusSelected = function () {
            var val = jq(this).val();
            if (val == 1065){
                jq('#tbl-test-results').show();
            }
            if (val == 1066){

                jq('#tbl-test-results').hide();
                jq('#tbl-positive-results').hide();
                       // clearing hidden sections
                var testResult=jq('#test-result');
                var covidStatus=jq('#covid-status');
                var admissionStatus=jq('#admission-status');
                var oxygenSupplement=jq('#oxygen');
                var ventilationSupplement=jq('#ventilator');
                jq("#isolation input[value=165994]").prop("checked", false);
                jq("#hdu input[value=165995]").prop("checked", false);
                jq("#icu input[value=161936]").prop("checked", false);
                getField('date-tested.value').val("");
                clearHiddenSections([testResult,covidStatus,admissionStatus,oxygenSupplement,ventilationSupplement]);
            }
        }

        var onPositiveResultSelected = function () {
            var val = jq(this).val();
            if (val == 703){
                jq('#tbl-positive-results').show();
            }
            if (val == 664){
                jq('#tbl-positive-results').hide();
            }
        }

        beforeSubmit.push(function() {
            //Date validations
            var encounterDate = getValue('encounter-date.value');
            var dateGiven = getValue('date-given.value');


            return true;
        });

        clearHiddenSections = function(parentObj) {
            for(var i=0; i &lt; parentObj.length; i++){
                parentObj[i].find('input[type=radio]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=checkbox]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=text]').each(function() {
                    this.val("");
                });
                parentObj[i].find('select').each(function() {
                    this.selectedIndex =0;
                });
            }
        }
	</script>
	<style>
		.simple-table {
			border: solid 1px #DDEEEE;
			border-collapse: collapse;
			border-spacing: 0;
			font: normal 13px Arial, sans-serif;
		}

		.simple-table thead th {
			background-color: #DDEFEF;
			border: solid 1px #DDEEEE;
			color: #336B6B;
			padding: 10px;
			text-align: left;
			text-shadow: 1px 1px 1px #fff;
		}

		.simple-table td {
			border: solid 1px #DDEEEE;
			color: #333;
			padding: 10px;
			text-shadow: 1px 1px 1px #fff;
		}
	</style>


	<div class="ke-form-header">
		<table style="width: 100%">
			<tr>
				<td>Encounter Date: <encounterDate id="encounter-date" showTime="true" /></td>
				<td>Location: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" /></td>

				<ifMode mode="EDIT">
					<script type="text/javascript">
                        jq(function(){

                            var patientVaccinated = getValue('patient-vaccinated.value');
                            var boosterGiven = getValue('booster-dose-given.value');
                            var hasBeenTested = getValue('test-status.value');
                            var hasBeenTestedPositive = getValue('test-result.value');

                                if (patientVaccinated == 1065){
                                    jq('#tbl-vaccine-1').show();
                                }else{
                                    jq('#tbl-vaccine-1').hide();
                                }

								if (boosterGiven == 1065){
                                    jq('#tbl-vaccine-booster').show();
								}else{
                                    jq('#tbl-vaccine-booster').hide();
								}

                            if (hasBeenTested == 1065 &amp;&amp; hasBeenTestedPositive == 703){
                                    jq('#tbl-test-results').show();
                                    jq('#tbl-positive-results').show();
                                }else{
                                    jq('#tbl-test-results').show();
                                   // jq('#tbl-positive-results').hide();
                                }

                        });
					</script>
				</ifMode>

			</tr>
		</table>
	</div>

	<div class="ke-form-content">
		<includeIf velocityTest="$patient.age &gt; 17">
		<fieldset id="vaccination-history">
			<legend>
				Vaccination History
			</legend>
		<table class="simple-table">
			<tr>
				<td> Have you ever been vaccinated
					<obs conceptId="163100AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerLabel="" style="radio" id="patient-vaccinated"/>
				</td>
			</tr>
		</table>
		<table class="simple-table" id="tbl-vaccine-1">
					<tr>
						<th>Vaccine</th>
						<th>Dose</th>
						<th>Date</th>
						<th>Verified</th>
					</tr>

			     <obsgroup groupingConceptId="1421AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
			    	<tr class="tr-vaccine-type-1">
					<td>
						<obs conceptId="984AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="166156AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166355AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166155AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166157AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166379AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                   5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Astrazeneca,
										   Johnson and Johnson,
									       Moderna,
										   Pfizer,
										   Sputnik,
										   Sinopharm,
										   Unknown
										   Other(Specify)"
							 style="dropdown" id="vaccine-type-1"/>

						<table id="tbl-other-vaccine-1" style="display: inline-block;" >
							<tr>
								<td> Vaccine name
									<obs id="other-vaccine-1" conceptId="161550AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
									&#160;&#160;&#160;
								</td>
							</tr>
						</table>
					</td>
					<td><obs class="dose"  conceptId="1418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="" answers="1,2" answerLabels="1,2" style="dropdown" /> </td>
					<td><obs class="vaccine-date" conceptId="1410AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  allowFutureDates="false" labelText=" " /></td>

					<td><obs conceptId="164464AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptId="164134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabel="" style="checkbox" id="verified"/>
					</td>
				</tr>
		 	</obsgroup>
				<br/>
			<obsgroup groupingConceptId="1421AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
			<!-- Second dose -->
				<tr class="tr-vaccine-type-2">

					<td>
						<obs conceptId="984AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="166156AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166355AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166155AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166157AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166379AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                   5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Astrazeneca,
										   Johnson and Johnson,
									       Moderna,
										   Pfizer,
										   Sputnik,
										   Sinopharm,
										   Unknown
										   Other(Specify)"
							 style="dropdown" id="vaccine-type-2"/>
						<table id="tbl-other-vaccine-2" style="display: inline-block;">
							<tr>
								<td> Vaccine name :
									<obs id="other-vaccine-2" conceptId="161550AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
									&#160;&#160;&#160;
								</td>
							</tr>
						</table>

					</td>
					<td><obs class="dose"  conceptId="1418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText="" answers="1,2" answerLabels="1,2" style="dropdown" id="dose-2" /> </td>

					<td><obs class="vaccine-date" conceptId="1410AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  allowFutureDates="false" labelText=" " id="vaccine-2-date" /></td>

					<td><obs conceptId="164464AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptId="164134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabel="" style="checkbox" id="verified-2"/>
					</td>

				</tr>
			</obsgroup>
		<tr>
			<td> Final Vaccination Status </td>
		   <td>
				<obs conceptId="164134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
					 answerConceptIds="166192AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,5585AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
					 answerLabels="Partially Vaccinated,Fully Vaccinated" style="radio" id="completed"/>
			</td>
		</tr>
		<tr>
				<td> Have you received a booster COVID -19 dose   </td>
			     <td>
					<obs conceptId="166063AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerLabels="Yes,No" style="radio" id="booster-dose-given"/>
				</td>
			</tr>
		</table>
		<table id="tbl-vaccine-booster">
			<tr>
							<tr>
								<th>Vaccine</th>
								<th>Dose No.</th>
								<th>Date</th>
								<th>Verified</th>
							</tr>
								<tr>
									<obsgroup groupingConceptId="1184AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA">
									<td>
										<obs conceptId="984AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerConceptIds="166156AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166355AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166154AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166155AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166157AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   166379AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
												                   1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                                   5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerLabels="Astrazeneca,
										   Johnson and Johnson,
									       Moderna,
										   Pfizer,
										   Sputnik,
										   Sinopharm,
										   Unknown
										   Other(Specify)"
											 style="dropdown" id="booster-type"/>
									</td>
									<td><obs class="dose" conceptId="1418AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"	 style="dropdown"	id="booster-dose"/></td>

									<td><obs class="vaccine-date" conceptId="1410AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  allowFutureDates="false"  labelText=" " id="booster-date" /></td>

									<td><obs conceptId="164464AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerConceptId="164134AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
											 answerLabel="" style="checkbox" id="booster-verified"/>
									</td>
									</obsgroup>
								</tr>
			     </tr>
		</table>
		</fieldset>
		</includeIf>
		<fieldset id="diagnosis-tab">
			<legend>
				Diagnosis and management
			</legend>
			<table class="simple-table">
				<tr>
					<td> Have you ever tested for COVID -19 </td>
					<td>
						<obs conceptId="165852AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No" style="radio" id="test-status"/>
					</td>
				</tr>
			</table>
			<table class="simple-table" id="tbl-test-results">
				<tr>
					<td> Test results for COVID -19 </td>
					<td>
						<obs conceptId="166638AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="703AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,664AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Positive,Negative" style="radio" id="test-result"/>
					</td>
				</tr>
			</table>
			<table  class="simple-table" id="tbl-positive-results">
				<tr>
					<td> Presentation of Covid-19 </td>
					<td>
						<obs conceptId="159640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1068AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,165912AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Symptomatic,Asymptomatic" style="radio" id="covid-status"/>
					</td>
				</tr>
				<tr>
					<td>Date tested  &#160;&#160;&#160;&#160;&#160;&#160;&#160; </td>
					<td>
						<obs conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowFutureDates="false" showTime="false" labelText=" " id="date-tested" />
					</td>
				</tr>
				<tr>
					<td> Hospital admission </td>
					<td>
						<obs conceptId="162477AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 style="radio" answerLabels="Yes,No" id="admission-status"/>
					</td>
				</tr>
				<tr>
					<td> Admission unit</td>

						<td style="text-align: left">
							<obs conceptId="161010AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptId="165994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabel="Isolation" style="checkbox" id="isolation" />
							<br/>
							<obs conceptId="161010AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptId="165995AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabel="HDU" style="checkbox" id="hdu" />
							<br/>
							<obs conceptId="161010AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerConceptId="161936AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
								 answerLabel="ICU" style="checkbox" id="icu" />
						</td>
				</tr>
				<tr>
					<td> Did you receive supplemental oxygen</td>
					<td style="text-align: left">
						<obs conceptId="165864AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No" style="radio" id="oxygen"/>
					</td>
				</tr>
				<tr>
					<td> Were you put on a ventilator</td>
					<td style="text-align: left">
						<obs conceptId="165932AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
							 answerLabels="Yes,No" style="radio" id="ventilator"/>
					</td>
				</tr>
			</table>
		</fieldset>
</div>
	<div class="ke-form-footer">
		<submit />
	</div>
</htmlform>